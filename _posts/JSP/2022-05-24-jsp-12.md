---
layout: single
title:  " DAY-58 JSP - ê²Œì‹œíŒ í˜ì´ì§€ë„¤ì´ì…˜, íŒŒì¼ ì˜¬ë¦¬ê¸°"
categories: JSP
tag: [JSP, ê²Œì‹œíŒ í˜ì´ì§€ë„¤ì´ì…˜, íŒŒì¼ ì˜¬ë¦¬ê¸°]
toc: true
toc_sticky: true
author_profile: false
sidebar:
  nav: "docs"
---



# ğŸ˜º 2022-05-24 / JSP

<!--Quote-->
> â— ìˆ˜ì—…ì„ ë“£ê³ , ê°œì¸ì´ ê³µë¶€í•œ ë‚´ìš©ì„ ì ì€ ê²ƒ ì´ê¸°ì— ì˜¤ë¥˜ê°€ ë§ì„ ìˆ˜ë„ ìˆìŒ


## 1ï¸âƒ£ í˜ì´ì§• êµ¬í˜„

### í•„ìš”í•œ ëª©ë¡

1. ì „ì²´ ê²Œì‹œê¸€ì˜ ê°œìˆ˜  // totalCnt
2. í•˜ë‚˜ì˜ í˜ì´ì§€ì—ì„œ ì´ ëª‡ê°œì˜ ê²Œì‹œê¸€ì„ ë„ìš¸ ê²ƒì¸ê°€  // recordCntPerPage
3. ë„¤ë¹„ë°”ì— ëª‡ê°œ ë‹¨ìœ„ë¡œ í˜ì´ì§•ì„ êµ¬ì„±í• ì§€ // naviCntPerPage
4. ì´ ëª‡ê°œì˜ í˜ì´ì§€ê°€ ë‚˜ì˜¬ì§€ // pageTotalCnt

### ì´ í˜ì´ì§€ì˜ ê°œìˆ˜

- 148ê°œì˜ ê²Œì‹œê¸€ì„ ê¸°ì¤€ìœ¼ë¡œ 10ê°œì”© í˜ì´ì§•ì„ í•´ì¤€ë‹¤ë©´ ì´ 15ê°œì˜ í˜ì´ì§€ê°€ ë‚˜ì™€ì•¼í•œë‹¤ â†’
pageTotalCtn = 15;
- 148 / 10  = 14í˜ì´ì§€ +1 = 15 í˜ì´ì§€
- 140 / 10  = 14í˜ì´ì§€ +1 = 15 í˜ì´ì§€(x) -> 14 í˜ì´ì§€ì—¬ì•¼ í•œë‹¤

```java
if(totalCnt % recordCntPerPage > 0) {  // ë‚˜ë¨¸ì§€ê°€ ìƒê¸´ë‹¤ëŠ” ê²ƒ
		pageTotalCnt = totalCnt / recordCntPerPage + 1;
}else { // ë‚˜ë¨¸ì§€ê°€ ìƒê¸°ì§€ ì•ŠëŠ” ê²ƒ -> ë”± ë§ì•„ ë–¨ì–´ì§€ëŠ” ê²ƒ
		pageTotalCnt = totalCnt / recordCntPerPage;
}
```

### ê°’ ë°©ì§€ ì²˜ë¦¬

- í˜„ì¬ í˜ì´ì§€ëŠ” ë°˜ë“œì‹œ 1ì´ìƒ
- í˜„ì¬ í˜ì´ì§€ëŠ” ì´ í˜ì´ì§€ì˜ ê°œìˆ˜ë¥¼ ë„˜ì–´ê°ˆ ìˆ˜ì—†ë‹¤

```java
if(curPage  < 1) { // í˜„ì¬ í˜ì´ì§€ê°€ 0ì´ê±°ë‚˜ í˜¹ì€ ìŒìˆ˜ì¼ë•Œ
		curPage = 1;
}else if(curPage > pageTotalCnt) { // í˜„ì¬ í˜ì´ì§€ê°€ ì´ í˜ì´ì§€ ìˆ˜ë³´ë‹¤ í¬ë‹¤ë©´
		curPage = pageTotalCnt; // ë¬´ì¡°ê±´ ë§ˆì§€ë§‰ í˜ì´ì§€ë¡œ ë§ì¶°ì£¼ê¸°
}
```

### í˜ì´ì§€ë„¤ì´ì…˜ ìˆ«ì Navì˜ ì‹œì‘í˜ì´ì§€ì™€ ë í˜ì´ì§€ ì„¤ì •

- í˜„ì¬ í˜ì´ì§€ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë„¤ë¹„ì˜ ì‹œì‘í˜ì´ì§€, ë í˜ì´ì§€ë¥¼ ì¡ì„ ê²ƒ
- ë§Œì•½ í˜„ì¬ í˜ì´ì§€ê°€ 3í˜ì´ì§€ë¼ë©´ ë„¤ë¹„ì˜ ì‹œì‘ í˜ì´ì§€ = 1 / ë„¤ë¹„ì˜ ë í˜ì´ì§€ = 5
- ë§Œì•½ í˜„ì¬ í˜ì´ì§€ê°€ 6í˜ì´ì§€ë¼ë©´ ë„¤ë¹„ì˜ ì‹œì‘ í˜ì´ì§€ = 6 / ë„¤ë¹„ì˜ ë í˜ì´ì§€ = 10
- ì‹œì‘ í˜ì´ì§€ = ((í˜„ì¬ í˜ì´ì§€ -1) / í˜ì´ì§€ ë‹¨ìœ„ ) * í˜ì´ì§€ ë‹¨ìœ„ + 1

```java
// í˜ì´ì§€ë„¤ì´ì…˜ ìˆ«ì
int startNavi = ((curPage - 1) / naviCntPerPage) * naviCntPerPage + 1; // ì‹œì‘ í˜ì´ì§€
int endNavi = startNavi + naviCntPerPage - 1;  // ë í˜ì´ì§€

// endNaviê°€ ì „ì²´ í˜ì´ì§€ë¥¼ ë„˜ì–´ê°ˆ ìˆ˜ ì—†ìŒ
if(pageTotalCnt < endNavi) { // endNaviê°€ ì „ì²´ í˜ì´ì§€ìˆ˜ë³´ë‹¤ í¬ë‹¤ë©´
	endNavi = pageTotalCnt;  // endNavië¥¼ ë§ˆì§€ë§‰ í˜ì´ì§€ë¡œ ìˆ˜ì •í•´ì£¼ê² ë‹¤.
}
```

### <> ëª¨ì–‘ì„ -> next, prev ëª¨ì–‘ì„ ë„£ì–´ì¤„ì§€ ì—¬ë¶€ ê²€ì‚¬

```java
boolean needPrev = true; // startNaviê°€ 1ì¼ë•Œ needPrevê°€ false
boolean needNext = true; // endNaviê°€ ë§ˆì§€ë§‰í˜ì´ì§€(ì „ì²´ í˜ì´ì§€)ì™€ ê°™ì„ë–„ needNextê°€ false

if(startNavi == 1) { // ì‹œì‘í˜ì´ì§€ê°€ ì²« ë²ˆì§¸ì´ë©´ prev ë²„íŠ¼ì´ í•„ìš”ê°€ ì—†ë‹¤
	needPrev = false;
}
if(endNavi == pageTotalCnt) { // ì‹œì‘í˜ì´ì§€ê°€ ëì´ë©´ next ë²„íŠ¼ì´ í•„ìš”ì—†ë‹¤
	needNext = false;
}
```

### ì˜¤ë¼í´

ë°ì´í„°ë¥¼ row_number()ì„ ì´ìš©í•˜ì—¬ 1~10ê°œ 11~20ê°œ ì´ëŸ°ì‹ìœ¼ë¡œ ì§¤ë¼ì„œ ë³´ë‚´ì¤˜ì•¼í•œë‹¤

â†’ seq ë²ˆí˜¸ê°€ í° ë²ˆí˜¸ì¸ê²Œ ê°€ì¥ ìµœì‹ ì´ê¸° ë•Œë¬¸ì— í° seqë¥¼ í° ìˆœì„œë¡œ ì •ë ¬ì„ í•´ì•¼í•œë‹¤

```java
select * from
  (select tbl_board.*, row_number() over(order by seq_board desc) as num from tbl_board)
 where num between 1 and 10;
```

- seq_boardìˆœìœ¼ë¡œ orderby í•œ row_numberì— numì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì¹˜í™˜í•œë‹¤
- betweenì˜ ìˆ«ìê°’ì„ daoì—ì„œ ? ë¡œ í•´ì¤˜ ê°’ì„ setIntë¡œ ìš°ë¦¬ê°€ ì„¤ì •í•´ì¤€ë‹¤

ê²Œì‹œê¸€ì˜ ìˆœìœ„ë¥¼ ë§¤ê²¨ì„œ íŠ¹ì • ìˆœìœ„ì˜ ë°ì´í„° ì¡°íšŒ

### ì¶œë ¥ ë°˜ë³µë¬¸(í˜ì´ì§€ë„¤ì´ì…˜ ë²ˆí˜¸)

board.jsp / boardControllerì—ì„œ ë°›ì•„ì˜¨ map ê°’

```java
${naviMap.startNavi}
${naviMap.endNavi}
${naviMap.needPrev}
${naviMap.needNext}
```

board.jsp

```java
<%-- pagination --%>
<nav>
  <ul class="pagination justify-content-center">
    <c:if test="${naviMap.needPrev eq true}">
    	<li class="page-item"><a class="page-link" href="/board.bo?curPage=${naviMap.startNavi-1}">Previous</a></li>
    	<%-- í˜„ì¬ 6í˜ì´ì§€ì— ìˆëŠ” ìƒíƒœì—ì„œ ì´ì „ ë²„íŠ¼ì„ í´ë¦­í–ˆì„ ë•Œ -> 5í˜ì´ì§€ë¡œ ì´ë™ --%>
    </c:if>

    <c:forEach var="pageNum" begin="${naviMap.startNavi}" end="${naviMap.endNavi}" step="1">
    	<li class="page-item"><a class="page-link" href="/board.bo?curPage=${pageNum}">${pageNum}</a></li>
    </c:forEach>

    <c:if test="${naviMap.needNext eq true}">
    	<li class="page-item"><a class="page-link" href="/board.bo?curPage=${naviMap.endNavi+1}">Next</a></li>
    </c:if>
  </ul>
</nav>
```

- pageNum ì´ë€ ë°˜ë³µë¬¸ì—ì„œ i ì™€ ê°™ì€ ìš”ì†Œ ê³„ì† ë™ì ìœ¼ë¡œ ë³€í™”
- begin = ì‹œì‘í˜ì´ì§€ end = ë í˜ì´ì§€ step = 1 â†’ í•˜ë‚˜ì”© í˜ì´ì§€ ì´ë™(ì¦‰ í•˜ë‚˜ì”© ìˆ«ìê°€ ë”í•´ì§)
- li í´ë¦­ì‹œ í•´ë‹¹ ìˆ«ì ë²ˆí˜¸ í˜ì´ì§€ë¡œ ì´ë™

index.jsp

```java
$("#btnBoard").on("click", function(){ // ê²Œì‹œíŒ ìš”ì²­
		location.href = "/board.bo?curPage=1";
})
```

- ê¸°ì¡´ì˜ "/board.bo";ì—ì„œ ë°”ê¿”ì¤€ë‹¤
- ê²Œì‹œíŒ ëª©ë¡ì„ í´ë¦­í•˜ë©´ curPage=1 ë¡œ defualtë˜ì„œ ë„˜ì–´ê°„ë‹¤

## 2ï¸âƒ£ íŒŒì¼ ì—…ë¡œë“œ

fileUpload.jsp

```java
<form action="/upload1.file" method="post" enctype="multipart/form-data">
	 <h2>íŒŒì¼ ì—…ë¡œë“œ1</h2>
	 <input type="file" name="file">
	 <button type="submit">ì—…ë¡œë“œ</button>
</form>
```

1. input type ="file"
2. ë°˜ë“œì‹œ post ë°©ì‹ìœ¼ë¡œ ì „ì†¡
3. form íƒœê·¸ì— enctype="multipart/form-data

FileController.java

```java
String uri = request.getRequestURI();
System.out.println("ìš”ì²­ uri : " + uri);

if(uri.equals("/upload1.file")) {
	System.out.println("íŒŒì¼ ì—…ë¡œë“œ ìš”ì²­");
	String file = request.getParameter("file");
	System.out.println("file : " + file);

	/* file requestë¥¼ ë°›ì•˜ì„ë•Œì—ëŠ” HttpServletRequestë¡œ ë°ì´í„°ë¥¼ ì¤„ ìˆ˜ ì—†ë‹¤

	* DBì— íŒŒì¼ì„ ì €ì¥í•˜ì§€ ì•Šì„ ê²ƒ -> ì„œë²„ì˜ ì»´í“¨í„°(ë¬¼ë¦¬ì  ê²½ë¡œ)ì— ì €ì¥
	* DB-> ì‹¤ì œ ì„œë²„ì˜ ì»´í“¨í„°ì— ì €ì¥ëœ íŒŒì¼ì˜ ê²½ë¡œê°’ë§Œ ì €ì¥
	* ControllerëŠ” í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ìš”ì²­ë°›ì€ íŒŒì¼ì´ ìˆë‹¤ë©´ DBì— ì €ì¥ëœ ê²½ë¡œê°’ì„ êº¼ë‚´ì„œ
	* InputStreamì„ ì´ìš©í•´ í•´ë‹¹ íŒŒì¼ì„ í”„ë¡œê·¸ë¨ìœ¼ë¡œ ë¶ˆëŸ¬ë“¤ì—¬ì˜¤ê³ , ê·¸ í›„ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ë‹¬
	* */
	// 1. tomcat ì„œë²„ì˜ root ê²½ë¡œ
	String realPath = request.getServletContext().getRealPath("");
	System.out.println("realPath : " + realPath);

	// 2. ì‹¤ì œ íŒŒì¼ì´ ë§Œë“¤ì–´ì§ˆ ê²½ë¡œê°’ì„ ì„¤ì • í•˜ëŠ” ê²ƒ // filesë¼ëŠ” í´ë” ìƒì„±
	String filePath = request.getServletContext().getRealPath("files");
	System.out.println("filePath : " + filePath);

	// 3. Fileì„ ì´ìš©í•´ ì‹¤ì œ ìœ„ì˜ ê²½ë¡œê°’ì´ ì¡´ì¬í•˜ëŠ” ì²´í¬ -> ì—†ë‹¤ë©´ í´ë” ìƒì„±
	File dir = new File(filePath);

	if(!dir.exists()) { // í´ë”ê°€ ì—†ë‹¤ë©´
		System.out.println("í´ë” ìƒì„±!");
		dir.mkdirs();
	}

	// 4. ì—…ë¡œë“œí•  íŒŒì¼ì˜ ìµœëŒ€í¬ê¸°ë¥¼ ì–¼ë§ˆë¡œ ì§€ì •í•´ì¤„ê±´ì§€
	// 1MB = 1024 * 1024 * 1
	// 10MB = 1024* 1024 * 10
	int maxSize = 1024* 1024 * 10;

	// MultipartRequest(request, íŒŒì¼ ì €ì¥ê²½ë¡œ, íŒŒì¼ ìµœëŒ€ í¬ê¸°, ì¸ì½”ë”©, íŒŒì¼ ì´ë¦„ ì¤‘ë³µ ì²˜ë¦¬ ë°©ì§€)
	MultipartRequest multi = new MultipartRequest(request,filePath,maxSize,"utf-8",new DefaultFileRenamePolicy());
	}
}
```

- cos ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©
- MultipartRequest ì‹¤ì œë¡œ íŒŒì¼ì„ ì˜¬ë¦´ìˆ˜ ìˆë„ë¡ ë•ëŠ” class