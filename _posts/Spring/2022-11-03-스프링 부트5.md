---
layout: single
title:  "ìŠ¤í”„ë§ ë¶€íŠ¸ ê¸°ì´ˆ - 5(JPAì˜ select,insert,update,delete)"
categories: SpringBoot
tag: [SpringBoot, select,insert,update,delete]
toc: true
toc_sticky: true
author_profile: true
sidebar:
  nav: "docs"
---

## Board

```java
@Entity
public class Board {

	@Id	// primary key
	@GeneratedValue(strategy = GenerationType.IDENTITY) // auto_increment
	private int id;

	@Column(nullable = false, length = 100)
	private String title;

	@Lob // ëŒ€ìš©ëŸ‰ ë°ì´í„°
	private String content;	// ì¸ë¨¸ë…¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©

	@ColumnDefault("0")
	private int count; // ì¡°íšŒìˆ˜

	@ManyToOne	// Many = Board, User = One	-> í•œëª…ì˜ UserëŠ” ì—¬ëŸ¬ê°œì˜ Boardë¥¼ ì“¸ìˆ˜ ìˆë‹¤.
	@JoinColumn(name ="userId")
	private User user; // DBëŠ” ì˜¤ë¸Œì íŠ¸ë¥¼ ì €ì¥í•  ìˆ˜ ì—†ë‹¤. FK, ìë°”ëŠ” ì˜¤ë¸Œì íŠ¸ë¥¼ ì €ì¥í•  ìˆ˜ ìˆë‹¤.

	@CreationTimestamp
	private Timestamp createDate;
}
```

ManyToOneì˜ FKëŠ” Userì˜ Primarykeyë¥¼ ì°¸ì¡°í•œë‹¤(ë”°ë¼ê°„ë‹¤)

â–¶ ì—°ê´€ê´€ê³„ ë§¤í•‘

ì—”í‹°í‹°ë“¤ì€ ì„œë¡œ ê´€ê³„ë¥¼ ë§ºê³  ìˆë‹¤. ê·¸ë˜ì„œ ì—”í‹°í‹°ë“¤ì´ ì–´ë– í•œ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ì§€ íŒŒì•…í•˜ëŠ” ê²ƒì´ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤.

ì—°ê´€ê´€ê³„ ë§¤í•‘ì´ë€ ê°ì²´ì˜ ì°¸ì¡°ì™€ í…Œì´ë¸”ì˜ ì™¸ë˜í‚¤ë¥¼ ë§¤í•‘í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.

JPAì—ì„œëŠ” JDBC(MyBatis)ë¥¼ ì‚¬ìš©í–ˆì„ ë•Œì™€ ë‹¬ë¦¬ ì—°ê´€ ê´€ê³„ì— ìˆëŠ” ìƒëŒ€ í…Œì´ë¸”ì˜ PKë¥¼ ë©¤ë²„ë³€ìˆ˜ë¡œ ê°–ì§€ ì•Šê³ , ì—”í‹°í‹° ê°ì²´ ìì²´ë¥¼ í†µì§¸ë¡œ ì°¸ì¡°í•œë‹¤(private User user)

1) ì˜ˆì‹œ

```java
// MyBatis
private Integer userId;

// JPA
private Board board;
```

<br/>

2) ë°©í–¥

**ë‹¨ë°©í–¥ ê´€ê³„**Â : ë‘ ì—”í‹°í‹°ê°€ ê´€ê³„ë¥¼ ë§ºì„ ë•Œ, í•œ ìª½ì˜ ì—”í‹°í‹°ë§Œ ì°¸ì¡°í•˜ê³  ìˆëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.

**ì–‘ë°©í–¥ ê´€ê³„**Â : ë‘ ì—”í‹°í‹°ê°€ ê´€ê³„ë¥¼ ë§ºì„ ë•Œ,Â ì–‘ ìª½ì´ ì„œë¡œ ì°¸ì¡°í•˜ê³  ìˆëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.

<br/>

3) ë‹¤ì¤‘ì„±

ê´€ê³„ì— ìˆëŠ” ë‘ ì—”í‹°í‹°ëŠ” ë‹¤ìŒ ì¤‘ í•˜ë‚˜ì˜Â ê´€ê³„ë¥¼ ê°–ëŠ”ë‹¤.

**Many To One**Â  Â - ë‹¤ëŒ€ì¼( N : 1 )

**One To Many**Â  Â - ì¼ëŒ€ë‹¤( 1 : N )

**One To One**Â  Â  - ì¼ëŒ€ì¼( 1 : 1 )

**Many To Many**Â - ë‹¤ëŒ€ë‹¤( N : N )

ì˜ˆë¥¼ë“¤ì–´ Board(ê²Œì‹œíŒ)ëŠ” ë§ì€ User(ì‚¬ìš©ì)ë¥¼ ê°–ê³  ìˆìœ¼ë¯€ë¡œ User(ì‚¬ìš©ì) ì…ì¥ì—ì„œëŠ” Board(ê²Œì‹œíŒ)ì™€ ì¼ëŒ€ë‹¤ ê´€ê³„ì´ë©°, Board(ê²Œì‹œíŒ)ì˜ ì…ì¥ì—ì„œëŠ” User(ì‚¬ìš©ì)ì— ì†í•˜ë¯€ë¡œ ë‹¤ëŒ€ì¼ ê´€ê³„ì…ë‹ˆë‹¤.

ì¦‰,Â **ì–´ë–¤ ì—”í‹°í‹°ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ìƒëŒ€ ì—”í‹°í‹°ë¥¼ ë°”ë¼ ë³´ëŠëƒì— ë”°ë¼ ë‹¤ì¤‘ì„±ì´ ë‹¤ë¦…ë‹ˆë‹¤.**

<br/>

 â–¶  @ManyToOne

@ManyToOne ì–´ë…¸í…Œì´ì…˜ì€ ì´ë¦„ ê·¸ëŒ€ë¡œ ë‹¤ëŒ€ì¼( N : 1 ) ê´€ê³„ ë§¤í•‘ ì •ë³´ì´ë‹¤

Board(ê²Œì‹œíŒ) ì…ì¥ì—ì„œëŠ”Â User(ì‚¬ìš©ì)ì™€Â ë‹¤ëŒ€ì¼ ê´€ê³„ì´ë¯€ë¡œ @ManyToOneì´ ëœë‹¤.

ì—°ê´€ê´€ê³„ë¥¼ ë§¤í•‘í•  ë•Œ ì´ë ‡ê²Œ ë‹¤ì¤‘ì„±ì„ ë‚˜íƒ€ë‚´ëŠ” ì–´ë…¸í…Œì´ì…˜(@ManyToMany, @OneToOne ë“±â€¦)ì€ í•„ìˆ˜ë¡œ ì‚¬ìš©í•´ì•¼ í•˜ë©°,Â **ì—”í‹°í‹° ìì‹ ì„ ê¸°ì¤€ìœ¼ë¡œ ë‹¤ì¤‘ì„±ì„ ìƒê°**í•´ì•¼ í•œë‹¤.

<br/>

â–¶  @JoinColumn

@JoinColumn ì–´ë…¸í…Œì´ì…˜ì€ ì™¸ë˜ í‚¤ë¥¼ ë§¤í•‘ í•  ë•Œ ì‚¬ìš©í•œë‹¤.

name ì†ì„±ì—ëŠ” ë§¤í•‘ í•  ì™¸ë˜ í‚¤ ì´ë¦„ì„ ì§€ì •í•œë‹¤.

Board(ê²Œì‹œíŒ) ì—”í‹°í‹°ì˜ ê²½ìš° User(ì‚¬ìš©ì)ì—”í‹°í‹°ì˜ idí•„ë“œë¥¼ ì™¸ë˜ í‚¤ë¡œ ê°€ì§€ë¯€ë¡œ, userIdë¥¼ ì‘ì„±í•˜ë©´ ë©ë‹ˆë‹¤.
<br/><br/>

## JPAë¡œ ë°ì´í„° Insert

â–¶ DummyControllerTest

```java
@RestController
public class DummyControllerTest {

	@Autowired // ì˜ì¡´ì„± ì£¼ì…(DI)
	private UserRepository userRepository;

	@PostMapping(value ="/dummy/join")
	public String join(User user) {
		System.out.println(user.getUsername());
		System.out.println(user.getPassword());
		System.out.println(user.getEmail());
		userRepository.save(user);
		return"íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.";
	}
}
```
<br/>
â–¶ UserRepository(interface)

```java
// DAO
// ìë™ìœ¼ë¡œ Bean ë“±ë¡ì´ ëœë‹¤. -> @Repository ìƒëµ ê°€ëŠ¥
public interface UserRepository extends JpaRepository<User, Integer>{
	// Userë¼ëŠ” í´ë˜ìŠ¤, IntegerëŠ” Userì˜ primary keyì˜ íƒ€ì…ëª…ì‹œ
}
```

![2.png](/assets/images/posts/2022-11-03/2.png)

í•´ë‹¹ ë§í¬ë¡œ ë°ì´í„°ë¥¼ ì…ë ¥í•˜ì—¬ MySQLì— ë°ì´í„°ë¥¼ insert í•˜ëŠ” ê²ƒ ê¹Œì§€ëŠ” ì„±ê³µí–ˆë‹¤. ê·¼ë° roleì—ëŠ” ì„¤ì •í•´ ë†“ì€ default ê°’ì´ ì•ˆë“¤ì–´ ê°€ê³  nullì´ ë“¤ì–´ê°”ë‹¤. default ê°’ ëŒ€ì‹ ì— insert ì‘ë™ì‹œ ê³„ì† nullë¡œ ë“¤ì–´ê°€ê¸° ë•Œë¬¸ì´ë‹¤.

![3.png](/assets/images/posts/2022-11-03/3.png)

ì¦‰ ì €ê¸°ì„œ roleì„ ì—†ì• ë©´ nullì´ ë“¤ì–´ê°ˆ ì¼ì´ ì—†ë‹¤. ê·¸ë˜ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ @DynamicInsertì´ë‹¤.

@DynamicInsertëŠ” insertì‹œ nullì¸ í•„ë“œë¥¼ ì œì™¸ì‹œì¼œì¤€ë‹¤.

â–¶ User

```java
@DynamicInsert
public class User {

	@Id	// primary key
	@GeneratedValue(strategy = GenerationType.IDENTITY)	// í”„ë¡œì íŠ¸ì—ì„œ ì—°ê²°ëœ DBì˜ ë„˜ë²„ë§ ì „ëµì„ ë”°ë¼ê°„ë‹¤.
	private int id; // ì‹œí€€ìŠ¤, auto_increment -> ë¹„ì›Œë‘ì–´ë„ ìë™ìœ¼ë¡œ ë“¤ì–´ê°

	@Column(nullable = false, length = 20)	// null ë¶ˆê°€, ê¸¸ì´ëŠ” 20
	private String username; // ì•„ì´ë””

	@Column(nullable = false, length = 100) // null ë¶ˆê°€, ê¸¸ì´ëŠ” 100
	private String password; // íŒ¨ìŠ¤ì›Œë“œ

	@Column(nullable = false, length = 50)
	private String email; // ì´ë©”ì¼

	@ColumnDefault(" 'user' ")
	private String role; // Enumì„ ì“°ëŠ”ê²Œ ì¢‹ë‹¤ // admin, user, manager

	@CreationTimestamp // ì‹œê°„ì´ ìë™ ì…ë ¥
	private Timestamp createDate; // ë¹„ì–´ë‘ì–´ë„ ìë™ìœ¼ë¡œ ë“¤ì–´ê°

}
```

@DynamicInsert ì‚¬ìš©í›„

![5.png](/assets/images/posts/2022-11-03/5.png)

ì •ìƒì ìœ¼ë¡œ ì˜ ë“¤ì–´ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

â— í•˜ì§€ë§Œ ì§„ì§œ Nullì´ í•„ìš”í•  ë•ŒëŠ” ì‚¬ìš©ì„ ëª»í•˜ê¸° ë•Œë¬¸ì— ë¹„íš¨ìœ¨ì„±ì„ ì•¼ê¸°í•  ìˆ˜ ìˆìŒ ê·¸ë˜ì„œ Enumì„ ì‚¬ìš©í•œë‹¤.

â–¶ User

```java
@Data
@NoArgsConstructor
@AllArgsConstructor
@Builder
@Entity	// User í´ë˜ìŠ¤ê°€ MySqlì— ìë™ìœ¼ë¡œ í…Œì´ë¸”ì— ìƒì„±ì´ ë˜ê²Œ ë„ì™€ì¤Œ
// @DynamicInsert
public class User {

	@Id	// primary key
	@GeneratedValue(strategy = GenerationType.IDENTITY)	// í”„ë¡œì íŠ¸ì—ì„œ ì—°ê²°ëœ DBì˜ ë„˜ë²„ë§ ì „ëµì„ ë”°ë¼ê°„ë‹¤.
	private int id; // ì‹œí€€ìŠ¤, auto_increment -> ë¹„ì›Œë‘ì–´ë„ ìë™ìœ¼ë¡œ ë“¤ì–´ê°

	@Column(nullable = false, length = 20)	// null ë¶ˆê°€, ê¸¸ì´ëŠ” 20
	private String username; // ì•„ì´ë””

	@Column(nullable = false, length = 100) // null ë¶ˆê°€, ê¸¸ì´ëŠ” 100
	private String password; // íŒ¨ìŠ¤ì›Œë“œ

	@Column(nullable = false, length = 50)
	private String email; // ì´ë©”ì¼

	//@ColumnDefault(" 'user' ")
	//private String role; // Enumì„ ì“°ëŠ”ê²Œ ì¢‹ë‹¤ // admin, user, manager

	@Enumerated(EnumType.STRING)	// Enumì˜ typeì´ Stringì´ë¼ëŠ” ê±¸ ëª…ì‹œí•´ì¤€ë‹¤.
	private RoleType role;

	@CreationTimestamp // ì‹œê°„ì´ ìë™ ì…ë ¥
	private Timestamp createDate; // ë¹„ì–´ë‘ì–´ë„ ìë™ìœ¼ë¡œ ë“¤ì–´ê°

}
```

â–¶ RoleType

```java
public enum RoleType {
	USER,ADMIN
}
```

![7.png](/assets/images/posts/2022-11-03/7.png)

roleì— USERë¼ê³  ì˜ë“¤ì–´ì˜¨ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

<br/>

## JPAë¡œ ë°ì´í„° ì¡°íšŒ (select)

â–¶ 1ë²ˆ

```java
// http://localhost:8088/dummy/user/2
@GetMapping(value = "/dummy/user{id}")	// {id} ì£¼ì†Œë¡œ íŒŒë¼ë¯¸í„°ë¥¼ ì „ë‹¬ ë°›ì„ ìˆ˜ ìˆìŒ.
public User detail(@PathVariable int id) {
	// user/3ì„ ì°¾ìœ¼ë©´ DBì—ëŠ” idê°€ 3ì¸ê°’ì´ ì—†ìœ¼ë¯€ë¡œ nullì´ ëœë‹¤
	// return ìœ¼ë¡œ nullì´ ë˜ë²„ë¦¬ë‹ˆê¹Œ ë¬¸ì œê°€ ìƒê¹€ -> ê·¸ë˜ì„œ JpaRepositoryì—ì„œ Optionalë¡œ ì´ê²ƒì„ í•´ê²° í•´ì¤Œ
	User user = userRepository.findById(id).orElseGet(new Supplier<User>() {	// findByIdí•´ì„œ ì—†ë‹¤ë©´ new Supplierë¥¼ í†µí•´ Userë¼ëŠ” ë¹ˆê°ì²´ ë°˜í™˜
		@Override
		public User get() {
			return new User();
		}
	});
	return user;
}
```

- orElseGet ëŒ€ì‹  get ì‚¬ìš© ê°€ëŠ¥í•˜ì§€ë§Œ orElseGetì´ë‚˜ orElseThrowë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ

â–¶ 2ë²ˆ

```java
// http://localhost:8088/dummy/user/2
@GetMapping(value = "/dummy/user{id}")	// {id} ì£¼ì†Œë¡œ íŒŒë¼ë¯¸í„°ë¥¼ ì „ë‹¬ ë°›ì„ ìˆ˜ ìˆìŒ.
public User detail(@PathVariable int id) {
	// user/3ì„ ì°¾ìœ¼ë©´ DBì—ëŠ” idê°€ 3ì¸ê°’ì´ ì—†ìœ¼ë¯€ë¡œ nullì´ ëœë‹¤
	// return ìœ¼ë¡œ nullì´ ë˜ë²„ë¦¬ë‹ˆê¹Œ ë¬¸ì œê°€ ìƒê¹€ -> ê·¸ë˜ì„œ JpaRepositoryì—ì„œ Optionalë¡œ ì´ê²ƒì„ í•´ê²° í•´ì¤Œ
	User user = userRepository.findById(id).orElseThrow(new Supplier<IllegalArgumentException>() {	// findByIdí•´ì„œ ì—†ë‹¤ë©´ new Supplierë¥¼ í†µí•´ Userë¼ëŠ” ë¹ˆê°ì²´ ë°˜í™˜
		@Override
		public IllegalArgumentException get() {
			return new IllegalArgumentException("í•´ë‹¹ ìœ ì €ëŠ” ì—†ìŠµë‹ˆë‹¤.id : " + id);
		}
	});
	// ëŒë‹¤ì‹
	//	User user = userRepository.findById(id).orElseThrow(()->{
	//		return new IllegalArgumentException("í•´ë‹¹ ì‚¬ìš©ìëŠ” ì—†ìŠµë‹ˆë‹¤");
	//	}));

	return user;
}
```

ì„±ê³µì‹œ

![8.png](/assets/images/posts/2022-11-03/8.png)

ì‹¤íŒ¨ì‹œ

![9.png](/assets/images/posts/2022-11-03/9.png)

<br/>


## JAP Pageable(í˜ì´ì§•)

```java
// ì „ì²´ ë°ì´í„° ì¡°íšŒ
@GetMapping(value = "/dummy/users")
public List<User> list() {
	return userRepository.findAll();
}

// í•œ í˜ì´ì§€ë‹¹ 2ê±´ì˜ ë°ì´í„°ë¥¼ ë¦¬í„´ë°›ì•„ ë³¼ ì˜ˆì •
@GetMapping(value = "/dummy/user")
public Page<User> pageList(@PageableDefault(size=2, sort="id", direction = Sort.Direction.DESC) Pageable pageable) {
												// 2ê±´ì”© ê°€ì ¸ì˜¤ê³  idë¥¼ ê¸°ì¤€ìœ¼ë¡œ, ìµœì‹ ìˆœ(DESC)ìœ¼ë¡œ ë³´ì—¬ì£¼ê¸°
	Page<User> users = userRepository.findAll(pageable);
	return users;
}

// ìœ„ì˜ ì½”ë“œë¥¼ ì¡°ê¸ˆ ë³€ê²½
@GetMapping(value = "/dummy/user")
public List<User> pageList(@PageableDefault(size=2, sort="id", direction = Sort.Direction.DESC) Pageable pageable) {
													// 2ê±´ì”© ê°€ì ¸ì˜¤ê³  idë¥¼ ê¸°ì¤€ìœ¼ë¡œ, ìµœì‹ ìˆœ(DESC)ìœ¼ë¡œ ë³´ì—¬ì£¼ê¸°
Page<User> pagingUser = userRepository.findAll(pageable);

List<User> users = pagingUser.getContent();
return users;
}
```

![10.png](/assets/images/posts/2022-11-03/10.png)
<br/><br/>

## JPAë¡œ ë°ì´í„° ì—…ë°ì´íŠ¸(update)

### save ì´ìš©

- save í•¨ìˆ˜ëŠ” idë¥¼ ì „ë‹¬í•˜ì§€ ì•Šìœ¼ë©´ insertë¥¼ í•´ì£¼ê³ 
- save í•¨ìˆ˜ëŠ” idë¥¼ ì „ë‹¬í•˜ê³   í•´ë‹¹ idì— ëŒ€í•œ ë°ì´í„°ê°€ ìˆìœ¼ë©´ updateë¥¼ í•´ì£¼ê³ 
- save í•¨ìˆ˜ëŠ” idë¥¼ ì „ë‹¬í•˜ê³   í•´ë‹¹ idì— ëŒ€í•œ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ insertë¥¼ í•´ì¤€ë‹¤.



```java
@PostMapping(value ="/dummy/user/{id}")
	public User updateUser(@PathVariable int id, @RequestBody User requestUser) {
		// JSONì„ ë°›ê¸° ìœ„í•´ @RequestBody ì‚¬ìš© -> JSONìœ¼ë¡œ ìš”ì²­í•´ë„ ìŠ¤í”„ë§ì´ Java Objectë¡œ ë³€í™˜
		// MesseageConverterì˜ Jackson ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë°›ì•„ì¤Œ
		System.out.println("id : " + id);
		System.out.println("password : " + requestUser.getPassword());
		System.out.println("email : " + requestUser.getEmail());

		requestUser.setId(id);	// idë¥¼ ì…‹
		requestUser.setUsername("lovelove");
		userRepository.save(requestUser);	// ì›ë˜ëŠ” insertí•  ë•Œ ì‚¬ìš©
		return null;
	}
```

í˜„ì¬ ìœ„ì—ì„œ passwordì™€ emailì„ update ì‹œì¼œì£¼ë ¤ê³  í•œë‹¤.

í•˜ì§€ë§Œ ì—ëŸ¬ê°€ ë°œìƒ -> usernameì´ not nullë¡œ ì¡í˜€ìˆê¸° ë•Œë¬¸ì´ë‹¤.

ê·¸ë˜ì„œ ê°•ì œë¡œ usernameì— ê°’ì„ ë„£ì–´ updateë¥¼ í•´ë³´ì•˜ë‹¤. í•˜ì§€ë§Œ ë‹¤ë¥¸ ê°’ë“¤ì´ nullë¡œ ë³€ê²½ë˜ë²„ë¦¬ëŠ” ìƒí™©ì´ ë°œìƒ (username, password, email ì œì™¸) ë”°ë¼ì„œ updateì—ëŠ” saveë¥¼ ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ

![11.png](/assets/images/posts/2022-11-03/11.png)
<br/><br/>

â–¶ ê·¸ëŸ¼ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œ?

```java
@PostMapping(value ="/dummy/user/{id}")
	public User updateUser(@PathVariable int id, @RequestBody User requestUser) {
		// JSONì„ ë°›ê¸° ìœ„í•´ @RequestBody ì‚¬ìš© -> JSONìœ¼ë¡œ ìš”ì²­í•´ë„ ìŠ¤í”„ë§ì´ Java Objectë¡œ ë³€í™˜
		// MesseageConverterì˜ Jackson ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë°›ì•„ì¤Œ
		System.out.println("id : " + id);
		System.out.println("password : " + requestUser.getPassword());
		System.out.println("email : " + requestUser.getEmail());

		User user = userRepository.findById(id).orElseThrow(()-> {
			return new IllegalArgumentException("ìˆ˜ì •ì— ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤.");
		});

		user.setPassword(requestUser.getPassword());
		user.setEmail(requestUser.getEmail());
		userRepository.save(user);
		return null;
	}
```

findByIdë¥¼ í†µí•´ì„œ ì¡´ì¬í•œ DBì— ì¡´ì¬í•˜ëŠ” ë°ì´í„°ë§Œ Updateë¥¼ ê°€ëŠ¥í•˜ê²Œ ë¨¼ì € íŒë³„ì„ í•´ì¤€ë‹¤.

ë°ì´í„°ê°€ ì¡´ì¬í•œë‹¤ë©´ í•´ë‹¹ ë°ì´í„°ì˜ Passwordì™€ Emailë§Œ ë³€ê²½ë˜ê²Œ í•œë‹¤(setì„ í†µí•´ì„œ).

ì²«ë²ˆì§¸ ë°©ì‹ì˜ ë¬¸ì œë¥¼ í•´ê²° í–ˆë‹¤ê³  í•˜ì§€ë§Œ ìœ„ì˜ ë°©ë²•ë“¤ì€ updateë¥¼ í•˜ê¸°ì—ëŠ” ì¢‹ì§€ ì•Šì€ ë°©ë²•ë“¤ì´ë‹¤.

ê·¸ë˜ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ @Transactionalì„ ì‚¬ìš©í•œë‹¤.

```java
@Transactional	// í•¨ìˆ˜ ì¢…ë£Œì‹œì— ìë™ commitì´ ë¨
@RestController
public class DummyControllerTest {

	@Autowired // ì˜ì¡´ì„± ì£¼ì…(DI)
	private UserRepository userRepository;

	// ì—…ë°ì´íŠ¸
	@PostMapping(value ="/dummy/user/{id}")
	public User updateUser(@PathVariable int id, @RequestBody User requestUser) {
		// JSONì„ ë°›ê¸° ìœ„í•´ @RequestBody ì‚¬ìš© -> JSONìœ¼ë¡œ ìš”ì²­í•´ë„ ìŠ¤í”„ë§ì´ Java Objectë¡œ ë³€í™˜
		// MesseageConverterì˜ Jackson ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë°›ì•„ì¤Œ
		System.out.println("id : " + id);
		System.out.println("password : " + requestUser.getPassword());
		System.out.println("email : " + requestUser.getEmail());

		User user = userRepository.findById(id).orElseThrow(()-> {
			return new IllegalArgumentException("ìˆ˜ì •ì— ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤.");
		});

		user.setPassword(requestUser.getPassword());
		user.setEmail(requestUser.getEmail());

		return user;
	}
```
<br/><br/>

## JPAë¡œ ë°ì´í„° ì‚­ì œ(delete)

```java
// ì‚­ì œ
@DeleteMapping(value = "/dummy/user/{id}")
public String deleteUser(@PathVariable int id) {
	try {
		userRepository.deleteById(id);
	}catch(Exception e) {
		return "ì‚­ì œì— ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤. í•´ë‹¹ idëŠ” DBì— ì—†ìŠµë‹ˆë‹¤!";
	}

	return "ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤. id : " + id;
}
```

deleteByIdë¥¼ ì´ìš©í•˜ì—¬ ì‚­ì œ

## ğŸ“‘ ì¶œì²˜

 - [ë©”íƒ€ì½”ë”©](https://www.youtube.com/c/%EB%A9%94%ED%83%80%EC%BD%94%EB%94%A9/playlists)
 - [ì—°ê´€ê´€ê³„ ë§¤í•‘](https://victorydntmd.tistory.com/208)
