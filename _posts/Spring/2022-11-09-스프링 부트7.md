---
layout: single
title:  "ìŠ¤í”„ë§ ë¶€íŠ¸ ê¸°ì´ˆ - 7(ìŠ¤í”„ë§ ì‹œíë¦¬í‹°, ê²Œì‹œê¸€ ì‘ì„±,ì¡°íšŒ)"
categories: SpringBoot
tag: [SpringBoot,ìŠ¤í”„ë§ ì‹œíë¦¬í‹°, ê²Œì‹œê¸€ ì‘ì„±,ì¡°íšŒ ]
toc: true
toc_sticky: true
author_profile: true
sidebar:
  nav: "docs"
---


ìŠ¤í”„ë§ ì‹œíë¦¬í‹° ë¡œê·¸ì¸ ë°©ë²•

```java
@Override
	protected void configure(HttpSecurity http) throws Exception {
		http
			.csrf().disable() // csrf í† í° ë¹„í™œì„±í™”(í…ŒìŠ¤íŠ¸ì‹œ ê±¸ìš°ë‘ëŠ”ê²Œ ì¢‹ìŒ)
			.authorizeRequests()
				.antMatchers("/", "/auth/**", "/js/**", "/css/**", "/image/**")
				.permitAll()
				.anyRequest()
				.authenticated()
			.and()
				.formLogin()
				.loginPage("/auth/loginForm")
				.loginProcessingUrl("/auth/loginProc") // ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ê°€ í•´ë‹¹ ì£¼ì†Œë¡œ ìš”ì²­ì˜¤ëŠ” ë¡œê·¸ì¸ì„ ê°€ë¡œì±ˆë‹¤. ëŒ€ì‹  ë¡œê·¸ì¸ í•´ì¤€ë‹¤.
				.defaultSuccessUrl("/");	// ì •ìƒì ìœ¼ë¡œ ë¡œê·¸ì¸ì´ ë˜ë©´ ì—¬ê¸°ë¡œ ì´ë™
	}
```

anyMathcersì— ë“±ë¡ë˜ì§€ ì•ŠëŠ” urlì€ /auth/loginFormìœ¼ë¡œ ë‹¤ ì´ë™
<br/>

## ê²Œì‹œê¸€ ì‘ì„±

â–¶ Board

```java
@Data
@NoArgsConstructor
@AllArgsConstructor
@Builder
@Entity
public class Board {

	@Id	// primary key
	@GeneratedValue(strategy = GenerationType.IDENTITY) // auto_increment
	private int id;

	@Column(nullable = false, length = 100)
	private String title;

	@Lob // ëŒ€ìš©ëŸ‰ ë°ì´í„°
	private String content;	// ì¸ë¨¸ë…¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©

	private int count; // ì¡°íšŒìˆ˜

	@ManyToOne	// Many = Board, User = One	-> í•œëª…ì˜ UserëŠ” ì—¬ëŸ¬ê°œì˜ Boardë¥¼ ì“¸ìˆ˜ ìˆë‹¤.
	@JoinColumn(name ="userId")
	private User user; // DBëŠ” ì˜¤ë¸Œì íŠ¸ë¥¼ ì €ì¥í•  ìˆ˜ ì—†ë‹¤. FK, ìë°”ëŠ” ì˜¤ë¸Œì íŠ¸ë¥¼ ì €ì¥í•  ìˆ˜ ìˆë‹¤.

	@OneToMany(mappedBy = "board", fetch = FetchType.EAGER)
	private List<Reply> reply;

	@CreationTimestamp
	private Timestamp createDate;
}
```
<br/>

â–¶ BoardApiController

```java
@RestController
public class BoardApiController {

	@Autowired
	private BoardService boardService;

	@ResponseBody
	@PostMapping(value = "/api/board")
	public ResponseDto<Integer> save(@RequestBody Board board, @AuthenticationPrincipal PrincipalDetail principal) {// title, content
		boardService.ê¸€ì“°ê¸°(board, principal.getUser());	// principal.getUser()ëŠ” í˜„ì¬ ì„¸ì…˜ì˜ ì•„ì´ë””ë¥¼ ì˜ë¯¸
		return new ResponseDto<Integer>(HttpStatus.OK.value(),1);
	}
}
```

saveFormì—ì„œ ì‘ì„±ëœ ë‚´ìš©ë“¤ì´ Boardë¡œ ë“¤ì–´ì˜¤ê²Œ ëœë‹¤. saveì˜ íŒŒë¼ë¯¸í„°ë¡œ ì“°ì¸@AuthenticationPrincipal PrincipalDetail principalëŠ” í˜„ì¬ ë¡œê·¸ì¸ ë˜ì–´ìˆëŠ” ì„¸ì…˜ì˜ ì•„ì´ë””ë¥¼ ì–»ê¸° ìœ„í•´ì„œ ì‚¬ìš© ë˜ì—ˆë‹¤.

<br/>
â–¶ BoardService

```java
@Service
public class BoardService {

	@Autowired
	private BoardRepository boardRepository;

	@Transactional
	public void ê¸€ì“°ê¸°(Board board, User user) {
		board.setCount(0);
		board.setUser(user);
		boardRepository.save(board);
	}

	public List<Board> ê¸€ëª©ë¡() {
		return boardRepository.findAll();	// findAllë¡œ ëª¨ë“  ê¸€ ê°€ì ¸ì˜¤ê¸°
	}

}
```

ê²Œì‹œê¸€ì˜ countì™€ userëŠ” ì§ì ‘ ì„¤ì •í•´ì¤€ë‹¤. ê·¸í›„ boardRepository.saveë¥¼ í†µí•´ ì €ì¥

<br/>
## ê²Œì‹œê¸€ ì¡°íšŒ

â–¶ BoardController

```java
@Controller
public class BoardController {

	@Autowired
	private BoardService boardService;

	@GetMapping(value = {"", "/"})
	public String index(Model model) {	// ì„¸ì…˜ ì ‘ê·¼
		model.addAttribute("boards",boardService.ê¸€ëª©ë¡());
		return "index";
	}

	@GetMapping(value = "/board/saveForm")
	public String saveForm() {	// ì„¸ì…˜ ì ‘ê·¼
		return "board/saveForm";
	}

}
```

í˜ì´ì§€ë¥¼ ë°©ë¬¸í•˜ê²Œ ë˜ë©´ Modelì„ indexë¡œ ì „ë‹¬í•œë‹¤.

<br/>
â–¶ BoardService

```java
// ìŠ¤í”„ë§ì´ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì„ í†µí•´ì„œ Beanì— ë“±ë¡ì„ í•´ì¤Œ. IoCë¥¼ í•´ì¤€ë‹¤.
@Service
public class BoardService {

	public List<Board> ê¸€ëª©ë¡() {
		return boardRepository.findAll();	// findAllë¡œ ëª¨ë“  ê¸€ ê°€ì ¸ì˜¤ê¸°
	}

}
```

findAllì„ í†µí•´ dbì— ìˆëŠ” ì „ì²´ ëª©ë¡ì„ ì–»ì–´ì˜¨ë‹¤.

<br/>
â–¶ index.jsp

```html
<!-- ë©”ì¸ -->
<div class="container">
 <c:forEach var="board" items="${boards}">
  <div class="card mt-3">
    <div class="card-body">
      <h5 class="card-title">${board.title}</h5>
      <p class="card-text">
        <small class="text-muted"><a href="#" class="btn btn-primary">ìƒì„¸ë³´ê¸°</a></small>
      </p>
    </div>
  </div>
 </c:forEach>
</div>
```

ê·¸ í›„ Modelì„ í†µí•´ ê°€ì ¸ì˜¨ boardsë¥¼ jstlì„ í™œìš©í•˜ì—¬ ë³´ì—¬ì¤€ë‹¤.

<br/>

## ê²Œì‹œê¸€ ì¡°íšŒ(í˜ì´ì§€ë„¤ì´ì…˜)

â–¶ BoardController

```java
@Controller
public class BoardController {

	@Autowired
	private BoardService boardService;

	@GetMapping(value = {"", "/"})
	public String index(Model model, @PageableDefault(size = 3, sort = "id", direction = Sort.Direction.DESC) Pageable pageable) {	// ì„¸ì…˜ ì ‘ê·¼
		model.addAttribute("boards",boardService.ê¸€ëª©ë¡(pageable));
		return "index";
	}
}
```

@PageableDefaultë¥¼ í™œìš©í•˜ì—¬ ìŠ¤í”„ë§ì—ì„œ ì œê³µí•˜ëŠ” í˜ì´ì§€ë„¤ì´ì…˜ ì‚¬ìš©

<br/>
â–¶ BoardService

```java
// ìŠ¤í”„ë§ì´ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì„ í†µí•´ì„œ Beanì— ë“±ë¡ì„ í•´ì¤Œ. IoCë¥¼ í•´ì¤€ë‹¤.
@Service
public class BoardService {

// ì „ì²´ ê¸€ ì¡°íšŒëŠ” List íƒ€ì…ì¸ë° pageableì„ ì ìš©í•˜ë©´ return íƒ€ì…ì€ Page íƒ€ì…ìœ¼ë¡œ ë³€ê²½ëœë‹¤
	public Page<Board> ê¸€ëª©ë¡(Pageable pageable) {
		return boardRepository.findAll(pageable);	// findAllë¡œ ëª¨ë“  ê¸€ ê°€ì ¸ì˜¤ê¸°
	}

}
```

@PageableDefaultì—ì„œ ì •í•´ì¤€ ê°¯ìˆ˜ëŒ€ë¡œ ë°ì´í„°ê°€ ë½‘í˜

<br/>
â–¶ index.jsp

```html
<!-- ë©”ì¸ -->
  <div class="container">
    <c:forEach var="board" items="${boards.content}">
      <div class="card mt-3">
        <div class="card-body">
          <h5 class="card-title">${board.title}</h5>
          <p class="card-text">
            <small class="text-muted"><a href="#" class="btn btn-primary">ìƒì„¸ë³´ê¸°</a></small>
          </p>
        </div>
      </div>
    </c:forEach>

    <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
    <nav aria-label="Page navigation example ">
      <ul class="pagination justify-content-center mt-3">
        <c:choose>
          <c:when test="${boards.first}">
            <li class="page-item disabled"><a class="page-link" href="?page=${boards.number-1}">Previous</a></li>
          </c:when>
          <c:otherwise>
            <li class="page-item"><a class="page-link" href="?page=${boards.number-1}">Previous</a></li>
          </c:otherwise>
        </c:choose>
         <c:choose>
          <c:when test="${boards.last}">
            <li class="page-item disabled"><a class="page-link" href="?page=${boards.number+1}">Next</a></li>
          </c:when>
          <c:otherwise>
            <li class="page-item"><a class="page-link" href="?page=${boards.number+1}">Next</a></li>
          </c:otherwise>
        </c:choose>
      </ul>
    </nav>
  </div>
```

ê°€ì¥ ì¤‘ìš”í•œ ê²ƒì€ forEachë¬¸ì˜ items ë¶€ë¶„ì´ ${boards}ì—ì„œ ${boards.content}ë¡œ ë°”ë€Œì—ˆë‹¤ â†’ ì¦‰ contentë¥¼ í•´ì•¼ ì¡°íšŒê°€ ê°€ëŠ¥í•˜ë‹¤

ìŠ¤í”„ë§ í˜ì´ì§€ë„¤ì´ì…˜ì˜ íŠ¹ì§•ì¸ firstì™€ last ë¶€ë¶„ì€ í˜ì´ì§€ë„¤ì´ì…˜ì´ ì‘ë™ì´ ì•ˆë˜ë„ë¡ ë¶€íŠ¸ìŠ¤íŠ¸ë©ì—ì„œ ì œê³µë˜ëŠ” disabled ì‚¬ìš©

<br/>
## DeleteMapping ì˜¤ë¥˜

<u>â€œrequest method 'delete' not supportedâ€</u> ì˜¤ë¥˜ ë°œìƒ

â–¶ application.yml

```java
spring:
  mvc:
    view:
      prefix: /WEB-INF/views/ # íŒŒì¼ëª… ì•ì— ë¶™ì–´ì¤Œ
      suffix: .jsp # íŒŒì¼ëª… ë’¤ì— ë¶™ì—¬ì¤Œ
    hiddenmethod:
      filter:
        enabled: true
```

- spring.mvc.hiddenmethod.filter.enabled = true ë¥¼ ì¶”ê°€

## ğŸ“‘ ì¶œì²˜
 - [ë©”íƒ€ì½”ë”©](https://www.youtube.com/c/%EB%A9%94%ED%83%80%EC%BD%94%EB%94%A9/playlists)