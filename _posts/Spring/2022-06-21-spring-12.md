---
layout: single
title:  "DAY-76 Spring Multipart, Service, ClassDiagram"
categories: Spring
tag: [Spring Multipart, Service, ClassDiagram]
toc: true
toc_sticky: true
author_profile: false
sidebar:
  nav: "docs"
---

# ğŸ’»2022-06-21

<!--Quote-->
> â— ìˆ˜ì—…ì„ ë“£ê³ , ê°œì¸ì´ ê³µë¶€í•œ ë‚´ìš©ì„ ì ì€ ê²ƒ ì´ê¸°ì— ì˜¤ë¥˜ê°€ ë§ì„ ìˆ˜ë„ ìˆìŒ

# 1ï¸âƒ£ ìŠ¤í”„ë§ File upload - multipart

```java
// signup.jspì—ì„œ submitì„ ëˆŒë €ì„ ë•Œ ë“¤ì–´ì˜¤ëŠ” ë©”ì„œë“œ
// íŒŒì¼ ë°ì´í„°ëŠ” MultipartFile í˜• ë³€ìˆ˜ë¡œ ë°›ì•„ì¤Œ
@RequestMapping(value ="/singup")
public String signup(MemberDTO dto, MultipartFile file, HttpSession session) throws Exception{
	System.out.println(dto.toString());
	System.out.println("file: " + file);

	// í”„ë¡œí•„ ì‚¬ì§„ì´ ì €ì¥ë  ê²½ë¡œ ì„¤ì •
	// C:\spring_workspace\.metadata\.plugins\org.eclipse.wst.server.core\tmp0\wtpwebapps\Board\ + profile
	String realPath = session.getServletContext().getRealPath("profile");
	System.out.println(realPath);

	// profile ì´ë¼ëŠ” í´ë” ìƒì„±
	File realPathFile =  new File(realPath);

	// í´ë”ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ í´ë” ë§Œë“¤ê¸°
	if(!realPathFile.exists()) {
		realPathFile.mkdir();
	}

	// profileì´ë¼ëŠ” í´ë”ì— fileì´ ìˆë‹¤ë©´(í´ë¼ì´ì–¸íŠ¸ë¡œ ë¶€í„° ë„˜ì–´ì˜¨ íŒŒì¼ì´ ìˆë‹¤ë©´)
	if(!file.isEmpty()) {
		// ëª©í‘œ : ìš°ë¦¬ê°€ ì§ì ‘ ë§Œë“¤ì–´ì¤€ sys_nameì„ ì´ìš©í•´ íŒŒì¼ì„ ì—…ë¡œë“œí•  ê²ƒ.

		// ì‹¤ì œ íŒŒì¼ì˜ ì´ë¦„ì„ ê°€ì ¸ì˜¤ê¸°
		String ori_name = file.getOriginalFilename();
		System.out.println("ori_name : " + ori_name);

		// UUID(ê³ ìœ  ì‹ë³„ê°’) -> ì¤‘ë³µë˜ëŠ” íŒŒì¼ëª…ì„ ì•ˆ ë§Œë“¤ê¸°ìœ„í•´ ì‚¬ìš©
		System.out.println(UUID.randomUUID());

		// sys_name ë§Œë“¤ê¸°
		String sys_name = UUID.randomUUID() + "_" + ori_name;
		System.out.println("sys_name : " + sys_name);

		// transferTo(ì‹¤ì œ íŒŒì¼ì´ ì €ì¥ë  full ê²½ë¡œ -> íŒŒì¼ ê°ì²´ ì´ìš©);
		// File.separator -> / ë¥¼ ë¦¬í„´í•´ì¤€ë‹¤
		file.transferTo(new File(realPath + File.separator + sys_name));
	}

	return "";
}
```

- session.getServletContext().getRealPath()ë¥¼ í†µí•´ í˜„ì¬ í´ë”ì˜ ìƒëŒ€ ê²½ë¡œë¥¼ ë³´ì—¬ì£¼ê³  ì¸ìê°’ìœ¼ë¡œ ìƒì„±í•˜ê³  ì‹¶ì€ í´ë”ëª…ì„ ì ëŠ”ë‹¤
- uuidë¥¼ í†µí•´ ëœë˜ê°’ ìƒì„± (ì¤‘ë³µ ë°©ì§€ë¥¼ ìœ„í•´ ì‚¬ìš©)
- File.separatorëŠ”  í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰ ì¤‘ì¸ OSì— í•´ë‹¹í•˜ëŠ” êµ¬ë¶„ìë¥¼ ë¦¬í„´
- ì‹¤ì œ ì—…ë¡œë“œë¥¼ í•˜ê¸° ìœ„í•´ transferTo()ë¥¼ ì´ìš©

## File Classì˜ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±

```java
1. ë””ë ‰í† ë¦¬ ìƒì„±
File dir = new File("ë””ë ‰í† ë¦¬ì˜ ê²½ë¡œ");
2. ë¶€ëª¨ ë””ë ‰í† ë¦¬ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
File newFile = new File(dir,"íŒŒì¼ëª…");
```

# 2ï¸âƒ£ Service ìƒì„±

- controllerê°€ ì§ì ‘ dao ë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šê³  serviceê°€ ê·¸ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê²Œ í•œë‹¤
- í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ê³¼ ì‘ë‹µê³¼ ê´€ë ¨ëœ ê°’ë§Œ controllerì—ì„œ ì²˜ë¦¬í•˜ê³  ì‘ì—…ì€ serviceê°€ í•œë‹¤

<span style="color: #2D3748; background-color:#fff5b1;">ê¸°ì¡´ MemberController</span>


```java
// id ì¤‘ë³µ ê²€ì‚¬
@ResponseBody // ajax ì–´ë…¸í…Œì´ì…˜
@RequestMapping(value ="/idCheck")
public String idCheck(String idCheckValue) throws Exception {
ArrayList<String> list = dao.selectId();
for(String id : list) {
	if(id.equals(idCheckValue)) {
		result = "impossible";
			}else {
				result = "possible";
			}
		}
	System.out.println("ì•„ì´ë”” ì²´í¬ : " + result);
	String result = service.idCheck(idCheckValue);
	return result;
}
```
<span style="color: #2D3748; background-color:#fff5b1;">ë³€ê²½ëœ MemberController</span>


```java
// id ì¤‘ë³µ ê²€ì‚¬
@ResponseBody
@RequestMapping(value ="/idCheck")
public String idCheck(String idCheckValue) throws Exception {
	String result = service.idCheck(idCheckValue); // serviceê°€ ëª¨ë“  ì¼ì„ í•´ê³  ê²°ê³¼ê°’ë§Œ ë„ì¶œ
	return result; // singup.jspì— ê°’ì„ ë³´ëƒ„
}
```

<span style="color: #2D3748; background-color:#fff5b1;">MemberService</span>


```java
package kh.board.member;

@Service
public class MemberService {

@Autowired
private MemberDAO dao;

public String idCheck(String idCheckValue) throws Exception {
	String result = "";
	ArrayList<String> list = dao.selectId();
	for(String id : list) {
		if(id.equals(idCheckValue)) {
			result = "impossible";
		}else {
			result = "possible";
		}
	}
	System.out.println("ì•„ì´ë”” ì²´í¬ : " + result);
	return result; // impossible or possible ê°’ì„ controllerì—ê²Œ ë³´ëƒ„
}
}
```

- MemberServiceì— Service ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ service ì—­í• ì„ í•œë‹¤ê³  ëª…ì‹œ
- ê¸°ì¡´ì— controllerì—ì„œ í–ˆë˜ ì‘ì—…ì„ serviceì—ì„œ ì²˜ë¦¬í•˜ê³  ê²°ê³¼ ê°’ë§Œ controllerì—ê²Œ ë³´ë‚´ì£¼ëŠ” ë°©ì‹ìœ¼ë¡œ ë³€ê²½

# 3ï¸âƒ£ í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

## ê¸°í˜¸ì˜ íŠ¹ì§•

```java
int _default; // ~  ì´í´ë¦½ìŠ¤ì—ì„œëŠ” íŒŒë€ìƒ‰
public int _public; // + // ì´í´ë¦½ìŠ¤ì—ì„œëŠ” ì´ˆë¡ìƒ‰
private int _private; // -  // ì´í´ë¦½ìŠ¤ì—ì„œëŠ” ë¹¨ê°„ìƒ‰
protected int _protected; // # // ì´í´ë¦½ìŠ¤ì—ì„œëŠ” ë…¸ë€ìƒ‰
```

## ê´€ê³„

- ì¼ë°˜í™” ê´€ê³„
1. ìƒì†ì„ í†µí•´ í´ë˜ìŠ¤ ê°„ì˜ ì°¸ì¡°ê°€ ì´ë¤„ì§€ëŠ” ê´€ê³„
2. í•˜ìœ„ í´ë˜ìŠ¤ê°€ ìƒìœ„ í´ë˜ìŠ¤ë¥¼ í™”ì‚´í‘œë¡œ ê°€ë¥´í‚¤ëŠ” í˜•íƒœ
3. ì‹¤ì„  + ë¹„ì–´ìˆëŠ” ì‚¼ê°í˜• í™”ì‚´í‘œ

![1.png](/assets/images/posts/2022-06-21/1.png)


- ì‹¤ì²´í™” ê´€ê³„
1. ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„ì„ í†µí•´ ì°¸ì¡°ë˜ëŠ” í´ë˜ìŠ¤ê°„ì˜ ê´€ê³„
2. ë¹„ì–´ìˆëŠ” ì‚¼ê°í˜• + ì ì„ 

![2.png](/assets/images/posts/2022-06-21/2.png)

- ì˜ì¡´ ê´€ê³„
1. í•˜ë‚˜ì˜ í´ë˜ìŠ¤ê°€ ë‹¤ë¥¸ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§¤ì„œë“œì˜ ë°˜í™˜íƒ€ì…, ë§¤ê°œë³€ìˆ˜(ì¸ìê°’), ë©”ì„œë“œ ë‚´ë¶€ì—ì„œ ì°¸ì¡°
2. ë©”ì„œë“œ ë‚´ë¶€ì—ì„œ ì°¸ì¡°ë˜ëŠ” ë‹¤ë¥¸ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ëŠ” ë©”ì„œë“œì˜ ìƒëª…ì£¼ê¸°ì™€ ë™ì¼
3. ì ì„  + ì—´ë ¤ìˆëŠ” í™”ì‚´í‘œë¡œ í‘œí˜„

![4.png](/assets/images/posts/2022-06-21/4.png)

![3.png](/assets/images/posts/2022-06-21/3.png)


- ì—°ê´€ ê´€ê³„ (ì§‘í•© ì—°ê´€)
1. ë©¤ë²„í•„ë“œë¡œ ë‹¤ë¥¸ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì°¸ì¡°í•˜ëŠ” ê´€ê³„
2. í•´ë‹¹ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒëª…ì„ ë‹¤í•´ë„ ì°¸ì¡°í•˜ê³  ìˆëŠ” í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ ìƒëª…ì£¼ê¸°ê°€ ì˜í–¥ì„ ë°›ì§€ ì•ŠëŠ” ê´€ê³„  â†’ ì¦‰ ìƒëª…ì£¼ê¸°ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ì—°ê´€ê´€ê³„
3. ì‹¤ì„  + ë¹„ì–´ìˆëŠ” ë§ˆë¦„ëª¨ë¡œ í‘œí˜„

```java
public class Character {
	private Watch watch;
	private Glasses glasses;

	public Character() {}
	public Character(Watch watch, Glasses glasses) {
		super();
		this.watch = watch;
		this.glasses = glasses;
	}

	public Watch getWatch() {
		return watch;
	}
	public void setWatch(Watch watch) {
		this.watch = watch;
	}
	public Glasses getGlasses() {
		return glasses;
	}
	public void setGlasses(Glasses glasses) {
		this.glasses = glasses;
	}
}
```

![5.png](/assets/images/posts/2022-06-21/5.png)



- ì—°ê´€ ê´€ê³„(í•©ì„± ì—°ê´€)
1. ë©¤ë²„í•„ë“œë¡œì¨ ë‹¤ë¥¸ í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì°¸ì¡°í•˜ëŠ” ê´€ê³„, ë‹¤ë§Œ ì°¸ì¡°í•˜ëŠ” í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ì™€ ì°¸ì¡°ë‹¹í•˜ëŠ” í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ ìƒëª…ì£¼ê¸°ê°€ ë™ì¼í•œ ê´€ê³„
2. ì‹¤ì„  + ì†ì´ ì°¨ìˆëŠ” ë§ˆë¦„ëª¨ë¡œ í‘œí˜„

```java
public class Character {
	private Watch watch = new Watch();
	private Glasses glasses = new Glasses();
}
```

![6.png](/assets/images/posts/2022-06-21/6.png)